<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <title>PDF to Speech Converter</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
</head>

<body class="bg-slate-100 font-sans text-slate-800 antialiased">

    <div class="container mx-auto max-w-6xl p-4 sm:p-6 lg:p-8">
        
        <!-- Header Section -->
        <div class="bg-white p-6 rounded-xl shadow-md mb-8">
            <h1 class="text-3xl font-bold text-slate-900 text-center">PDF to Speech Converter</h1>
            <p class="text-center text-slate-500 mt-2">Upload a PDF, customize the voice, and convert it to audio.</p>
        </div>

        <!-- Main Controls & Preview Layout -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            
            <!-- Left Column: All Controls -->
            <div class="bg-white p-6 rounded-xl shadow-md space-y-6">
                
                <!-- Step 1: File Upload -->
                <div>
                    <label for="pdfFile" class="block text-lg font-semibold text-slate-700 mb-2">1. Select PDF File</label>
                    <input onchange="onFileChange()" type="file" id="pdfFile" accept="application/pdf" class="block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 cursor-pointer"/>
                </div>

                <!-- Step 2: Voice Customization -->
                <div>
                    <h2 class="text-lg font-semibold text-slate-700 mb-4">2. Customize Voice</h2>
                    <div class="space-y-5">
                        <!-- Voice Selection -->

                        
                        <div class="flex flex-col sm:flex-row items-start sm:items-center gap-2">
                            <label for="voices" class="w-20 shrink-0 font-medium text-slate-600">Voice:</label>
                            <select name="voices" id="voices" class="flex-1 block w-full bg-slate-50 border border-slate-300 text-slate-900 rounded-lg focus:ring-blue-500 focus:border-blue-500 p-2.5">
                                <option value="af-ZA-AdriNeural">Adri (Female, Afrikaans)</option>
                                <option value="en-GB-SoniaNeural" selected>Sonia (Female, English UK)</option>
                                <option value="en-US-JennyNeural">Jenny (Female, English US)</option>
                                <!-- Add other voices as needed -->
                            </select>
                            <button class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg">Test Voice</button>
                        </div>
                        
                        <!-- Pitch, Rate, Volume Controls -->
                        <div class="flex items-center gap-4">
                            <label for="pitch" class="w-16 shrink-0 font-medium text-slate-600">Pitch:</label>
                            <input oninput="updatePitch()" type="range" name="pitch" id="pitch" min="-100" max="100" value="0" class="flex-1 h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-blue-600">
                            <span class="w-20 text-right font-mono text-slate-500"><span id="pitchDisplay">0</span> Hz</span>
                        </div>
                        <div class="flex items-center gap-4">
                            <label for="rate" class="w-16 shrink-0 font-medium text-slate-600">Rate:</label>
                            <input oninput="updateRate()" type="range" name="rate" id="rate" min="-100" max="100" value="0" class="flex-1 h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-blue-600">
                            <span class="w-20 text-right font-mono text-slate-500"><span id="rateDisplay">0</span> %</span>
                        </div>
                        <div class="flex items-center gap-4">
                            <label for="volume" class="w-16 shrink-0 font-medium text-slate-600">Volume:</label>
                            <input oninput="updateVolume()" type="range" name="volume" id="volume" min="-100" max="100" value="0" class="flex-1 h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-blue-600">
                            <span class="w-20 text-right font-mono text-slate-500"><span id="volumeDisplay">0</span> %</span>
                        </div>

                        <!-- START: NEW Collapsible Voice Test Area -->
                                                <!-- START: NEW Collapsible Voice Test Area with Textarea -->
                        <div class="border-t border-slate-200 pt-5">

                            <!-- Clickable Header to Toggle the Test Area -->
                            <button onclick="toggleTestArea()" id="toggleTestAreaButton" type="button" class="w-full flex justify-between items-center text-left p-3 bg-slate-100 rounded-lg hover:bg-slate-200 transition-colors focus:outline-none focus:ring-2 focus:ring-slate-400">
                                <span class="font-semibold text-slate-700">Test Current Voice</span>
                                <!-- Icons for Collapsed/Expanded State -->
                                <span class="text-slate-500">
                                    <!-- Collapsed Icon (Chevron Down) -->
                                    <svg id="icon-collapsed" class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />
                                    </svg>
                                    <!-- Expanded Icon (Chevron Up) - Hidden by default -->
                                    <svg id="icon-expanded" class="w-5 h-5 hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 15.75 7.5-7.5 7.5 7.5" />
                                    </svg>
                                </span>
                            </button>

                            <!-- The Collapsible Content - Hidden by default -->
                            <div id="voiceTestContent" class="hidden pt-4 space-y-3">
                                
                                <!-- The NEW Textarea for user input -->
                                <div>
                                    <label for="testTextInput" class="sr-only">Text to test</label>
                                    <textarea id="testTextInput" rows="3" class="block w-full p-2.5 bg-white border border-slate-300 text-slate-900 rounded-lg focus:ring-blue-500 focus:border-blue-500" placeholder="Type text to test here..."></textarea>
                                </div>

                                <!-- Container for the Test button and audio player -->
                                <div class="flex items-center gap-4">
                                    <button onclick="testVoice()" id="testVoiceButton" class="bg-slate-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-slate-700 transition-colors disabled:bg-slate-400 disabled:cursor-wait">
                                        Test
                                    </button>
                                    <div class="flex-1">
                                        <!-- iFrame for playing the test audio -->
                                        <iframe id="testAudioIframe" class="w-full h-12 rounded-lg" src="" frameborder="0"></iframe>
                                    </div>
                                </div>
                                
                            </div>

                        </div>
                        <!-- END: NEW Collapsible Voice Test Area with Textarea -->
                                                <!-- END: NEW Collapsible Voice Test Area -->
                    </div>
                </div>

                <!-- Step 3: Upload and Download -->
                <div>
                    <h2 class="text-lg font-semibold text-slate-700 mb-2">3. Generate & Download</h2>
                    <div class="space-y-4">
                        <button onclick="uploadPDF()" id="uploadButton" class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors duration-300 focus:outline-none focus:ring-4 focus:ring-blue-300 disabled:bg-slate-400 disabled:cursor-not-allowed">
                            1. Upload and Get Link
                        </button>
                        <button onclick="downloadAudioFile()" id="downloadButton" disabled class="w-full bg-green-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-700 transition-colors duration-300 focus:outline-none focus:ring-4 focus:ring-green-300 disabled:bg-slate-400 disabled:cursor-not-allowed">
                            2. Download and Play Audio
                        </button>
                    </div>
                </div>
                
                <!-- Status & Audio Player (iFrame as required by your script) -->
                <!-- Start of the section to be replaced -->
                <div class="space-y-4">

                    <!-- NEW: Beautifully styled wrapper for the audio player -->
                    <!-- It starts as hidden. Your script will make this visible. -->
                    <div id="audioPlayerWrapper" class="p-4 bg-slate-50 rounded-lg border border-slate-200">

                        <!-- A clear label for the user -->
                        <h3 class="text-md font-semibold text-slate-700 mb-3">
                            Generated Audio
                        </h3>

                        <!-- THIS IS THE IFRAME YOUR SCRIPT IS LOOKING FOR -->
                        <!-- We've added 'rounded-lg' to make its corners match the container -->
                        <iframe id="audioIframe" class="w-full rounded-lg" src="" frameborder="0"></iframe>

                    </div>

                    <!-- The old status div. Your script doesn't use it, but it's harmless. -->
                    <div id="status"></div>

                </div>
                <!-- End of the section to be replaced -->

                    

            </div>
            <!-- Right Column: PDF Preview (iFrame as required by your script) -->
            <div class="bg-white p-2 rounded-xl shadow-md max-h-[600px]">
                <!-- THIS IS THE IFRAME YOUR SCRIPT IS LOOKING FOR -->
                <iframe id="pdfIframe" src="" class="w-full h-[600px] lg:h-full rounded-lg" hidden frameborder="0"></iframe>
            </div>

        </div>
    </div>

    <!-- Your external JavaScript file is linked here -->
    <script src="script.js"></script>
</body>
</html>